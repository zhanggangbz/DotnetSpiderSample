using DotnetSpider.Downloader;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace DotnetSpiderSample.Common
{
    class BaseFunction
    {

        /// <summary> 
        /// 获取当前时间戳 
        /// </summary> 
        /// <returns></returns> 
        public static string GetTimeStamp()
        {
            TimeSpan ts = DateTime.UtcNow - new DateTime(1970, 1, 1, 0, 0, 0, 0);
            return Convert.ToInt64(ts.TotalMilliseconds).ToString();
        }

        public static decimal TryParseDecimal(string value)
        {
            value = value.Trim();
            decimal de = 0;
            decimal.TryParse(value,out de);
            return de;
        }

        public static int TryParseInt(string value)
        {
            value = value.Trim();
            int de = 0;
            int.TryParse(value, out de);
            return de;
        }

        public static DateTime TryParseDateTime(string value)
        {
            value = value.Trim();
            DateTime de = DateTime.Now;
            DateTime.TryParse(value, out de);
            return de;
        }

        /// <summary>
        /// 时间戳转时间
        /// </summary>
        /// <param name="timeStamp"></param>
        /// <returns></returns>
        public static DateTime GetTimeFromTimeStamp(long timeStamp)
        {
            System.DateTime startTime = TimeZone.CurrentTimeZone.ToLocalTime(new System.DateTime(1970, 1, 1)); // 当地时区
            return startTime.AddMilliseconds(timeStamp);
        }

        public static Request CreateRequest(string url)
        {
            Request request = new Request(url);

            request.Accept = "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3";
            request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36";
            request.Headers.Add("Cookie", "_ga=GA1.2.732476233.1569740004; UM_distinctid=16d7bcb9cfc150-0655e016d1d0cb-5b123211-1fa400-16d7bcb9cfd585; yfx_c_g_u_id_10000001=_ck19092914532918801215922519611; smidV2=20190929145330e8ea56ab6f13c3982de44264d7152dab00540586c016df730; jingjiren_cookiekey=%5B%22%257B%2522url%2522%253A%2522%252Fjingjiren%252F_%2525E8%252583%2525A1%2525E4%2525B8%252580%2525E6%25259E%2525AD%253Fzn%253D%2525E8%252583%2525A1%2525E4%2525B8%252580%2525E6%25259E%2525AD%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522%25E8%2583%25A1%25E4%25B8%2580%25E6%259E%25AD%2522%252C%2522total%2522%253A%25220%2522%257D%22%5D; ershoufang_cookiekey=%5B%22%257B%2522url%2522%253A%2522%252Fershoufang%252F_%2525E9%252597%2525B2%2525E6%25259E%252597%2525E5%2525B1%2525B1%2525E6%2525B0%2525B4%253Fzn%253D%25E9%2597%25B2%25E6%259E%2597%25E5%25B1%25B1%25E6%25B0%25B4%2526searchtype%253D3%2522%252C%2522x%2522%253A%2522120.02112%2522%252C%2522y%2522%253A%252230.24106%2522%252C%2522name%2522%253A%2522%25E9%2597%25B2%25E6%259E%2597%25E5%25B1%25B1%25E6%25B0%25B4%255Cn%2522%252C%2522total%2522%253A150%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fershoufang%252Fwuchang%253Fzn%253D%25E4%25BA%2594%25E5%25B8%25B8%2526searchtype%253D2%2522%252C%2522x%2522%253A%2522120.04413%2522%252C%2522y%2522%253A%252230.24746%2522%252C%2522name%2522%253A%2522%25E4%25BA%2594%25E5%25B8%25B8%255Cn%2522%252C%2522total%2522%253A734%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fershoufang%252F_%2525E4%2525BA%252594%2525E5%2525B8%2525B8%253Fzn%253D%2525E4%2525BA%252594%2525E5%2525B8%2525B8%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522%25E4%25BA%2594%25E5%25B8%25B8%2522%252C%2522total%2522%253A%25220%2522%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fjingjiren%252F_%2525E5%2525BC%2525A0%2525E9%2525AB%252598%2525E5%2525B2%2525AD%253Fzn%253D%2525E5%2525BC%2525A0%2525E9%2525AB%252598%2525E5%2525B2%2525AD%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522%25E5%25BC%25A0%25E9%25AB%2598%25E5%25B2%25AD%2522%252C%2522total%2522%253A%25220%2522%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fershoufang%252F_%2525E8%252583%2525A1%2525E4%2525B8%252580%2525E6%25259E%2525AD%253Fzn%253D%2525E8%252583%2525A1%2525E4%2525B8%252580%2525E6%25259E%2525AD%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522%25E8%2583%25A1%25E4%25B8%2580%25E6%259E%25AD%2522%252C%2522total%2522%253A%25220%2522%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fershoufang%252F_170903717829%253Fzn%253D170903717829%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522170903717829%2522%252C%2522total%2522%253A%25220%2522%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fershoufang%252F_%2525E7%2525BB%2525BF%2525E5%25259F%25258E%2525E6%2525A1%252583%2525E6%2525BA%252590%2525E5%2525B0%25258F%2525E9%252595%252587%253Fzn%253D%2525E7%2525BB%2525BF%2525E5%25259F%25258E%2525E6%2525A1%252583%2525E6%2525BA%252590%2525E5%2525B0%25258F%2525E9%252595%252587%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522%25E7%25BB%25BF%25E5%259F%258E%25E6%25A1%2583%25E6%25BA%2590%25E5%25B0%258F%25E9%2595%2587%2522%252C%2522total%2522%253A%25220%2522%257D%22%2C%22%257B%2522url%2522%253A%2522%252Fershoufang%252F_181212780014%253Fzn%253D181212780014%2522%252C%2522x%2522%253A%25220%2522%252C%2522y%2522%253A%25220%2522%252C%2522name%2522%253A%2522181212780014%2522%252C%2522total%2522%253A%25220%2522%257D%22%5D; _gid=GA1.2.44776756.1570611501; PHPSESSID=4c2ca9gama6innu0e69312ibs6; Hm_lvt_94ed3d23572054a86ed341d64b267ec6=1569828487,1570501347,1570611500,1570685633; ershoufang_BROWSES=90064801%2C90204623%2C39684639; domain=hz; CNZZDATA1256793290=1079960969-1569738317-%7C1570694183; yfx_f_l_v_t_10000001=f_t_1569740009876__r_t_1570685627762__v_t_1570699274088__r_c_4; _gat=1; _Jo0OQK=71D25E6B22AF63F235BBD389F3D2BFA629AD7BD3D9606D40529D38A8443E56449FEF545038C6F7E345EA652F19F3CD031B7A608EE96909444B52F7C6EC71F43ED6AFFBBE0C390CBD8D41F7A141E52F240311F7A141E52F24031E699D297008E92C0ED0B7D8BF95AF442GJ1Z1WQ==; Hm_lpvt_94ed3d23572054a86ed341d64b267ec6=1570699294");
            return request;
        }
    }
}
